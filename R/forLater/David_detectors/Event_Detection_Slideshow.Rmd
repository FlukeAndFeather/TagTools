---
title: "Event Detection"
author: David Sweeney
date: 8 August 2017
output: ioslides_presentation
---

## Signal Detection Theory

- Definition:
    - The process of discerning between noise and a signal
- What is noise?
    - Irrelevant and undesired stimuli
- What is a signal?
    - Informative and unique stimuli
```{r, echo=FALSE, message=FALSE}
require(tagtools)
library(readr)
bw11_210a_tagdata <- read_csv("~/DeRuiter2017/Datasets/bw11_210a_tagdata.csv")
Aw <- cbind(bw11_210a_tagdata$Awx, bw11_210a_tagdata$Awy, bw11_210a_tagdata$Awz)
sampling_rate <- bw11_210a_tagdata$fs[1]  
jerk <- njerk(Aw, sampling_rate)
graphics::plot(jerk, type = "l", col = "blue", xlim = c(0, length(jerk)), ylim = c(0, max(jerk)), xlab = "Time" , ylab = "Signal Power")
```


## Detection Threshold

- Definition:
    - The ratio of signal power to noise power required for a signal to be present
- A threshold is set by a preassigned level of detection correctness
- Helpful example: Hearing tests
```{r, echo=FALSE, message=FALSE}
djerk <- jerk[0:40000]
graphics::plot(djerk, type = "l", col = "blue", xlim = c(0, length(djerk)), ylim = c(0, max(djerk)), xlab = "Time" , ylab = "Signal Power")
thresh <- quantile(djerk, .99)
graphics::abline(a = thresh, b = 0, col = "red", lty=2)
```


## Setting a Threshold

- Thresholds that are too high:
    - Many missed detections
    - Low probability of FP and TP
- Thresholds that are too low:
    - Many FP and TP detections
- Optimal threshold level:
    - High rate of TP and low rate of FP
    - ROC Curves
```{r, echo=FALSE}
djerk <- jerk[0:40000]
graphics::plot(djerk, type = "l", col = "blue", xlim = c(0, length(djerk)), ylim = c(0, max(djerk)), xlab = "Time" , ylab = "Signal Power")
thresh <- quantile(djerk, .99)
graphics::abline(a = thresh, b = 0, col = "red", lty=2)
```


## Blanking Time

- Definition:
    - Amount of time within within which all values exceeding the threshold level constitute the same signal.
```{r, echo=FALSE}
dnew <- jerk[640:740]
graphics::plot(dnew, type = "l", col = "blue", xlim = c(0, length(dnew)), ylim = c(0, max(dnew)), xlab = "Time" , ylab = "Signal Power")
graphics::abline(a = .4, b = 0, col = "red", lty=2)
```


## ROC Curve

- Receiver Operating Characteristic curves plot rate of TP detections against rate of FP detections
- Two main purposes:
    - Determine overall performance of signal detector
    - Help set the optimal threshold level
```{r, echo=FALSE}
eventscsv <- read.csv("~/DeRuiter2017/Datasets/bw11_210aLungeTimes.csv")
events <- eventscsv[,2]
ROC_plot(Aw, 5, njerk, 35, 76834, events, ((76834/5)/35))
```


# Example: Automated Detection of Lunge Feeding

## Detecting Events

## Generate ROC Curve

## Improve Overall Detection
